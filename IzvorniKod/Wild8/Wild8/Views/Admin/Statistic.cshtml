@model Wild8.Models.StatisticsModel
@{ 
    Layout = null;
}

<div class="panel panel-default">
    <div class="panel-heading">
        <h4>Statistika</h4>
    </div>

    <div class="panel-content container">
        <div id="chartdiv" style="width: 100%; height: 400px; background-color: #FFFFFF;"></div>
        <h4>Ukupna prosječna cijena: @Html.DisplayFor(model => model.TotalAveragePrice) kn<br /></h4>
        <h4>Najviše naručivana jela:</h4>
        <ol>
            @{ int counter = 0; }
            @foreach (var meal in Model.TotalTopMeals)
            {
                <text><li>@meal.Key - x<b/>@meal.Value</li></text>
                counter++;

                if (counter >= 3)
                {
                    break;
                }
            }
        </ol>
        <h4>Ukupan broj narudžbi: @Html.DisplayFor(model => model.TotalNumOfOrders)</h4>
    </div>
</div>

<!-- amCharts javascript sources -->
<script type="text/javascript" src="~/Scripts/ViewScripts/Charts/amcharts.js"></script>
<script type="text/javascript" src="~/Scripts/ViewScripts/Charts/serial.js"></script>
<script type="text/javascript" src="~/Scripts/ViewScripts/Charts/themes/light.js"></script>
<script type="text/javascript" src="~/Scripts/ViewScripts/Charts/lang/hr.js"></script>

<!-- amCharts javascript code -->
<script type="text/javascript">
    AmCharts.makeChart("chartdiv",
        {
            "type": "serial",
            "language": "hr",
            "categoryField": "date",
            "dataDateFormat": "YYYY-MM",
            "autoMarginOffset": 40,
            "marginRight": 60,
            "marginTop": 60,
            "fontSize": 13,
            "handDrawScatter": 4,
            "theme": "light",
            "categoryAxis": {
                "parseDates": true
            },
            "chartCursor": {
                "enabled": true
            },
            "chartScrollbar": {
                "enabled": true
            },
            "trendLines": [],
            "graphs": [
                {
                    "columnWidth": 10,
                    "cornerRadiusTop": 8,
                    "dashLength": 4,
                    "fillAlphas": 0.51,
                    "id": "AmGraph-1",
                    "lineAlpha": 0.44,
                    "title": "graph 1",
                    "type": "column",
                    "valueField": "orders"
                },
                {
                    "bullet": "square",
                    "bulletBorderAlpha": 1,
                    "bulletBorderThickness": 1,
                    "bulletSize": 16,
                    "id": "AmGraph-2",
                    "lineThickness": 3,
                    "title": "graph 2",
                    "valueField": "column-2"
                }
            ],
            "guides": [],
            "valueAxes": [
                {
                    "id": "ValueAxis-1",
                    "title": ""
                }
            ],
            "allLabels": [],
            "balloon": {},
            "titles": [],
            "dataProvider": [
                @foreach (var pair in Model.OrdersByMonths)
                {
                    <text>
                    {
                        "date": "@pair.Key",
                        "orders": @pair.Value
                        },
                    </text>
                }
            ]
        }
    );
</script>

